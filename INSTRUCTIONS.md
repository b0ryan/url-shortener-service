# Инструкция по использованию сервиса сокращения ссылок

## Быстрый старт

### 1. Компиляция проекта

```bash
javac -d target/classes -encoding UTF-8 -sourcepath src/main src/main/*.java src/main/model/*.java src/main/service/*.java src/main/util/*.java
```

Или используйте скрипт (Windows):
```bash
compile.bat
```

### 2. Запуск приложения

```bash
java -cp target/classes UrlShortenerApp
```

Или используйте скрипты (Windows):
- `compile_and_run.bat` - компиляция и запуск одной командой
- `run.bat` - только запуск (если проект уже скомпилирован)

## Основные функции

### Создание короткой ссылки

1. Запустите приложение
2. Выберите пункт меню `1`
3. Введите длинный URL (например: `https://www.baeldung.com/java-9-http-client`)
4. Введите лимит переходов (или нажмите Enter для значения по умолчанию - 10)
5. Введите время жизни ссылки:
   - Формат: число + единица измерения
   - Примеры: `24ч`, `3д`, `12 часов`, `2 дня`, `48h`, `1d`
   - Единицы: `ч`/`час`/`часов`/`h`/`hour`/`hours` (часы) или `д`/`день`/`дней`/`d`/`day`/`days` (дни)
   - По умолчанию: 24 часа (если нажать Enter)
6. **ВАЖНО:** Сохраните ваш User ID, который будет показан после создания первой ссылки!

**Пример:**
```
Введите URL для сокращения: https://www.baeldung.com/java-9-http-client
Введите лимит переходов (или Enter для 10): 5
Введите время жизни ссылки (например: 24ч, 3д, 12 часов) или Enter для 24 часов: 2д

✅ Ссылка успешно создана!
Короткая ссылка: clck.ru/3DZHeG
Оригинальный URL: https://www.baeldung.com/java-9-http-client
Лимит переходов: 5
Срок действия: 2 дня
Ваш User ID: 550e8400-e29b-41d4-a716-446655440000
```

### Переход по короткой ссылке

1. Выберите пункт меню `2`
2. Введите короткую ссылку (например: `clck.ru/3DZHeG`)
3. Браузер автоматически откроется с оригинальным URL

**Примечание:** Если лимит переходов исчерпан или срок действия истек, вы получите уведомление.

### Просмотр своих ссылок

1. Выберите пункт меню `3`
2. Убедитесь, что установлен правильный User ID (пункт меню `7`)

Вы увидите список всех ваших ссылок с подробной информацией:
- Оригинальный URL
- Количество переходов / Лимит
- Дата создания и истечения
- Статус (активна/недоступна)

### Редактирование ссылки

1. Выберите пункт меню `4`
2. Введите короткую ссылку для редактирования
3. Измените лимит переходов (или нажмите Enter, чтобы оставить без изменений)
4. Измените время жизни ссылки (например: 24ч, 3д) или нажмите Enter, чтобы оставить без изменений
5. При изменении параметров счетчик переходов или время жизни будут сброшены

**Важно:** Редактировать ссылку может только её владелец.

### Удаление ссылки

1. Выберите пункт меню `5`
2. Введите короткую ссылку для удаления
3. Ссылка будет удалена (только если вы являетесь её владельцем)

**Важно:** Удалить ссылку может только её владелец.

### Работа с User ID

**Показать User ID:**
- Пункт меню `6` - показывает текущий User ID

**Установить User ID:**
- Пункт меню `7` - позволяет ввести существующий User ID для доступа к ранее созданным ссылкам

**Важно:** User ID необходим для:
- Просмотра всех ваших ссылок
- Редактирования ссылок
- Удаления ссылок
- Управления ссылками в будущем

## Тестирование функциональности

### Тест 1: Уникальность ссылок для разных пользователей

1. Запустите приложение
2. Создайте ссылку для URL `https://example.com` (запомните User ID и короткую ссылку)
3. Выйдите из приложения (пункт `0`)
4. Запустите приложение снова
5. Установите другой User ID (пункт `7`, введите новый UUID)
6. Создайте ссылку для того же URL `https://example.com`
7. **Результат:** Должна быть создана другая короткая ссылка

### Тест 2: Лимит переходов

1. Создайте ссылку с лимитом переходов = 2
2. Перейдите по ссылке дважды (пункт `2`)
3. Попробуйте перейти в третий раз
4. **Результат:** Должно появиться уведомление "Лимит переходов исчерпан"

### Тест 3: Время жизни ссылки

1. Создайте ссылку с небольшим временем жизни (например, `1ч`)
2. Подождите истечения срока
3. Попробуйте перейти по ссылке
4. **Результат:** Должно появиться уведомление "Срок действия ссылки истек"

### Тест 4: Уведомления

Проверьте, что уведомления появляются в следующих случаях:
- ✅ Лимит переходов исчерпан
- ✅ Срок действия ссылки истек
- ✅ Ссылка не найдена
- ✅ Попытка редактировать чужую ссылку
- ✅ Попытка удалить чужую ссылку

### Тест 5: Автоматическое открытие браузера

1. Создайте ссылку
2. Перейдите по ней (пункт `2`)
3. **Результат:** Браузер должен автоматически открыться с оригинальным URL

## Структура проекта

```
src/main/
├── model/
│   ├── Link.java              # Модель ссылки
│   └── User.java              # Модель пользователя
├── service/
│   ├── LinkService.java       # Основной сервис
│   ├── ShortUrlGenerator.java # Генератор коротких ссылок
│   └── StorageService.java    # Сервис сохранения/загрузки данных
├── util/
│   ├── BrowserOpener.java    # Открытие браузера
│   └── NotificationService.java # Уведомления
└── UrlShortenerApp.java       # Главное приложение
```

## Технические детали

- **Хранилище:** In-memory с автоматическим сохранением на диск (данные сохраняются в директорию `data/` и загружаются при следующем запуске)
- **Время жизни ссылки:** Настраивается пользователем при создании ссылки (по умолчанию 24 часа). Можно указать в часах или днях
- **Автоматическая очистка:** Каждую минуту удаляются просроченные ссылки
- **Формат короткой ссылки:** `clck.ru/XXXXXX` (6 символов + префикс из UUID)

## Решение проблем

### Браузер не открывается автоматически

Если браузер не открывается автоматически, система покажет сообщение с URL, который можно открыть вручную.

### User ID потерян

Если вы потеряли User ID, вы не сможете получить доступ к ранее созданным ссылкам. Рекомендуется сохранять User ID в безопасном месте.

### Ссылка не найдена

Возможные причины:
- Ссылка была удалена
- Срок действия ссылки истек
- Неверно введена короткая ссылка