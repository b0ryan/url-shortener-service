# Сервис сокращения ссылок

Сервис для сокращения длинных URL с возможностью управления лимитом переходов и временем жизни ссылки.

## Основные возможности

- ✅ **Создание коротких ссылок** - преобразование длинных URL в короткие ссылки вида `clck.ru/XXXXXX`
- ✅ **Уникальные ссылки для каждого пользователя** - один и тот же URL для разных пользователей создает разные короткие ссылки
- ✅ **Лимит переходов** - пользователь может задать максимальное количество переходов по ссылке
- ✅ **Ограничение времени жизни** - пользователь может задать время жизни ссылки (в часах или днях)
- ✅ **Уведомления пользователя** - система уведомляет о недоступности ссылки (лимит исчерпан или срок истек)
- ✅ **Идентификация по UUID** - каждый пользователь идентифицируется уникальным UUID
- ✅ **Автоматическое открытие в браузере** - переход по короткой ссылке открывает оригинальный URL в браузере

## Требования

- Java 11 или выше

## Установка и запуск

1. Клонируйте репозиторий или скачайте проект
2. Откройте терминал в директории проекта
3. Скомпилируйте проект:
   ```bash
   javac -d target/classes -encoding UTF-8 -sourcepath src/main src/main/*.java src/main/model/*.java src/main/service/*.java src/main/util/*.java
   ```
4. Запустите приложение:
   ```bash
   java -cp target/classes UrlShortenerApp
   ```
   
   Или используйте скрипт `compile_and_run.bat` (Windows)

## Использование

### Создание короткой ссылки

1. Выберите пункт меню `1. Создать короткую ссылку`
2. Введите длинный URL (например, `https://www.baeldung.com/java-9-http-client`)
3. Введите лимит переходов (или нажмите Enter для значения по умолчанию - 10)
4. Введите время жизни ссылки:
   - Формат: число + единица измерения
   - Примеры: `24ч`, `3д`, `12 часов`, `2 дня`, `48h`, `1d`
   - Единицы: `ч`/`час`/`часов`/`h`/`hour`/`hours` (часы) или `д`/`день`/`дней`/`d`/`day`/`days` (дни)
   - По умолчанию: 24 часа (если нажать Enter)
5. Система создаст уникальную короткую ссылку и покажет ваш User ID

**Важно:** Сохраните ваш User ID! Он нужен для доступа к вашим ссылкам в будущем.

### Переход по короткой ссылке

1. Выберите пункт меню `2. Перейти по короткой ссылке`
2. Введите короткую ссылку (например, `clck.ru/3DZHeG`)
3. Браузер автоматически откроется с оригинальным URL

### Просмотр своих ссылок

1. Выберите пункт меню `3. Просмотреть мои ссылки`
2. Вы увидите список всех ваших ссылок с информацией о:
   - Оригинальном URL
   - Количестве переходов
   - Лимите переходов
   - Дате создания и истечения
   - Статусе (активна/недоступна)

### Редактирование ссылки

1. Выберите пункт меню `4. Редактировать ссылку`
2. Введите короткую ссылку для редактирования
3. Измените лимит переходов (или нажмите Enter, чтобы оставить без изменений)
4. Измените время жизни ссылки (или нажмите Enter, чтобы оставить без изменений)
5. При изменении параметров счетчик переходов или время жизни будут сброшены

**Важно:** Редактировать ссылку может только её владелец.

### Удаление ссылки

1. Выберите пункт меню `5. Удалить ссылку`
2. Введите короткую ссылку для удаления
3. Ссылка будет удалена (только если вы являетесь её владельцем)

**Важно:** Удалить ссылку может только её владелец.

### Работа с User ID

- **Показать User ID**: пункт меню `6` - показывает ваш текущий User ID
- **Установить User ID**: пункт меню `7` - позволяет установить существующий User ID для доступа к ранее созданным ссылкам

## Особенности реализации

### Уникальность ссылок

Каждый пользователь получает уникальную короткую ссылку даже для одного и того же URL. Это достигается за счет:
- Использования UUID пользователя в генерации ссылки
- Комбинирования UUID и оригинального URL для создания уникального хеша

### Автоматическая очистка

Система автоматически удаляет просроченные ссылки каждую минуту. Время жизни ссылки задаётся пользователем при создании.

### Уведомления

Пользователь получает уведомления в следующих случаях:
- Лимит переходов исчерпан
- Срок действия ссылки истек
- Ссылка не найдена
- Попытка редактировать или удалить чужую ссылку

## Структура проекта

```
src/main/
├── model/
│   ├── Link.java          # Модель короткой ссылки
│   └── User.java          # Модель пользователя
├── service/
│   ├── LinkService.java   # Основной сервис для работы со ссылками
│   ├── ShortUrlGenerator.java  # Генератор коротких ссылок
│   └── StorageService.java     # Сервис сохранения/загрузки данных
├── util/
│   ├── BrowserOpener.java      # Утилита для открытия браузера
│   └── NotificationService.java # Сервис уведомлений
└── UrlShortenerApp.java   # Главное консольное приложение
```

## Примеры использования

### Пример 1: Создание ссылки

```
Введите URL для сокращения: https://www.baeldung.com/java-9-http-client
Введите лимит переходов (или Enter для 10): 5
Введите время жизни ссылки (например: 24ч, 3д, 12 часов) или Enter для 24 часов: 2д

✅ Ссылка успешно создана!
Короткая ссылка: clck.ru/3DZHeG
Оригинальный URL: https://www.baeldung.com/java-9-http-client
Лимит переходов: 5
Срок действия: 2 дня
```

### Пример 2: Переход по ссылке

```
Введите короткую ссылку: clck.ru/3DZHeG
Переход на: https://www.baeldung.com/java-9-http-client
Открываю в браузере...
✅ Браузер открыт!
```

### Пример 3: Уведомление об исчерпании лимита

```
═══════════════════════════════════════
⚠️ УВЕДОМЛЕНИЕ
═══════════════════════════════════════
Короткая ссылка: clck.ru/3DZHeG
Оригинальный URL: https://www.baeldung.com/java-9-http-client
Причина: Лимит переходов исчерпан
Переходов использовано: 5 / 5
═══════════════════════════════════════
```

## Технические детали

- **Хранилище данных**: In-memory (ConcurrentHashMap) с автоматическим сохранением на диск
- **Сохранение данных**: Данные автоматически сохраняются в директорию `data/` при каждом изменении (создание/удаление ссылок, переходы)
- **Загрузка данных**: При запуске приложения данные автоматически загружаются с диска
- **Поток очистки**: Daemon thread, проверяет просроченные ссылки каждую минуту
- **Генерация ссылок**: Комбинация UUID пользователя, оригинального URL и случайных символов
- **Время жизни**: Настраивается пользователем при создании ссылки (по умолчанию 24 часа). Можно указать в часах или днях. Просроченные ссылки автоматически удаляются

